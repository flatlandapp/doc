# 2.3 Mathematical Model: Behavior Verification

The key to the TW Protocol lies in its rigorous mathematical model, which ensures the authenticity, validity, and consistency of behaviors generated by AI agents.

## 2.3.1 Behavior Signing

Each behavior $A_i$ is signed using the player's private key, with the signing function defined as:

$$S_i = \text{Sign}(A_i, K_{priv})$$

Where:
- $A_i$ is behavior data, including behavior type, parameters, and timestamp
- $K_{priv}$ is the player's private key
- $S_i$ is the digital signature of the behavior

The smart contract verifies the signature's validity using the player's public key $K_{pub}$:

$$\text{Verify}(S_i, A_i, K_{pub}) = \text{True} \iff \text{Signature is valid}$$

## 2.3.2 Behavior Validity Verification

The validity of behavior $A_i$ is determined by three aspects:

1. **Rule Consistency Function $R(A_i)$**:
   Verifies if the behavior complies with game rules, defined as:

   $$R(A_i) = \text{True} \quad \text{if } A_i \text{ complies with game rules}$$
   $$R(A_i) = \text{False} \quad \text{otherwise}$$

2. **State Consistency Function $S(A_i)$**:
   Verifies if the behavior is consistent with the character's current state, defined as:

   $$S(A_i) = \text{True} \quad \text{if } A_i \text{ is consistent with character's current state}$$
   $$S(A_i) = \text{False} \quad \text{otherwise}$$

3. **Temporal Consistency Function $T(A_i)$**:
   Verifies if the behavior's timestamp is reasonable, defined as:

   $$T(A_i) = \text{True} \quad \text{if } t_{A_i} > t_{last} \text{ and } t_{A_i} < t_{now} + \Delta t$$
   $$T(A_i) = \text{False} \quad \text{otherwise}$$

   Where $t_{A_i}$ is the behavior's timestamp, $t_{last}$ is the previous behavior's timestamp, $t_{now}$ is the current time, and $\Delta t$ is the allowed time deviation.

The final validity determination of behavior $A_i$ is:

$$\text{Valid}(A_i) = R(A_i) \land S(A_i) \land T(A_i)$$

Only when $\text{Valid}(A_i) = \text{True}$ will the behavior be applied to the game world.

## 2.3.3 Behavior Entropy and Uncertainty

To ensure AI agents generate behaviors with sufficient diversity and unpredictability, the TW Protocol introduces the concept of behavior entropy:

$$H(A) = -\sum_{i=1}^{n} p(a_i) \log_2 p(a_i)$$

Where:
- $H(A)$ is the entropy of behavior set $A$
- $p(a_i)$ is the probability of behavior $a_i$
- $n$ is the total number of possible behaviors

The protocol requires that the behavior entropy generated by AI agents meets a minimum threshold $H_{min}$:

$$H(A) \geq H_{min}$$

This ensures that AI agent behaviors are not overly deterministic or predictable, increasing game diversity and interest.
